local HttpService = game:GetService("HttpService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local LocalPlayer = game:GetService("Players").LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local CoreGui = game:GetService("CoreGui")

if not isfolder("Orion") then
	makefolder("Orion")
end

local gameFolder = nil
local AutoloadFile = nil
ConfigData = {}
Elements = {}
CURRENT_VERSION = nil
CurrentConfigName = nil

function GetConfigList()
	local configs = {}
	if isfolder and listfiles and gameFolder then
		local files = listfiles(gameFolder)
		for _, filepath in pairs(files) do
			local filename = filepath:match("([^/\\]+)%.json$")
			if filename then
				table.insert(configs, filename)
			end
		end
	end
	return configs
end

function GetAutoload()
	if isfile and AutoloadFile and isfile(AutoloadFile) then
		local s, c = pcall(function() return readfile(AutoloadFile) end)
		if s and c and c ~= "" then return c:match("^%s*(.-)%s*$") end
	end
	return nil
end

function SetAutoload(n)
	if writefile and AutoloadFile then writefile(AutoloadFile, n) end
end

function ClearAutoload()
	if delfile and AutoloadFile and isfile(AutoloadFile) then delfile(AutoloadFile) end
end

function SaveConfigAs(n)
	if not n or n == "" then return false end
	if writefile and gameFolder then
		ConfigData._version = CURRENT_VERSION
		writefile(gameFolder .. "/" .. n .. ".json", HttpService:JSONEncode(ConfigData))
		CurrentConfigName = n
		return true
	end
	return false
end

function LoadConfig(n)
	if not n or n == "" or not CURRENT_VERSION then return false end
	local fp = gameFolder .. "/" .. n .. ".json"
	if isfile and isfile(fp) then
		local s, r = pcall(function() return HttpService:JSONDecode(readfile(fp)) end)
		if s and type(r) == "table" and r._version == CURRENT_VERSION then
			ConfigData = r
			CurrentConfigName = n
			LoadConfigElements()
			return true
		end
	end
	return false
end

function DeleteConfig(n)
	if not n or n == "" then return false end
	local fp = gameFolder .. "/" .. n .. ".json"
	if delfile and isfile(fp) then
		delfile(fp)
		if GetAutoload() == n then ClearAutoload() end
		return true
	end
	return false
end

function LoadConfigElements()
	for key, el in pairs(Elements) do
		if ConfigData[key] ~= nil and el.Set then
			pcall(function() el:Set(ConfigData[key], true) end)
		end
	end
end

function ResetElements()
	ConfigData = { _version = CURRENT_VERSION }
	for key, el in pairs(Elements) do
		if el.Set then
			pcall(function()
				if key:match("^Toggle_") then el:Set(false)
				elseif key:match("^Slider_") then el:Set(20)
				elseif key:match("^Input_") then el:Set("")
				elseif key:match("^Dropdown_") then
					if type(el.Value) == "table" then el:Set({}) else el:Set(nil) end
				end
			end)
		end
	end
end

function LoadExternalConfigFromJSON(json)
	if not json or json == "" then return false end
	local ok, data = pcall(function() return HttpService:JSONDecode(json) end)
	if not ok or type(data) ~= "table" then return false end
	if data._version and CURRENT_VERSION and data._version ~= CURRENT_VERSION then return false end
	ConfigData = data
	for key, el in pairs(Elements) do
		if data[key] ~= nil and el.Set then
			pcall(function() el:Set(data[key], true) end)
		end
	end
	return true
end

local Icons = {
	player = "rbxassetid://12120698352",
	web = "rbxassetid://137601480983962",
	bag = "rbxassetid://8601111810",
	shop = "rbxassetid://4985385964",
	cart = "rbxassetid://128874923961846",
	plug = "rbxassetid://137601480983962",
	settings = "rbxassetid://70386228443175",
	loop = "rbxassetid://122032243989747",
	gps = "rbxassetid://17824309485",
	compas = "rbxassetid://125300760963399",
	gamepad = "rbxassetid://84173963561612",
	boss = "rbxassetid://13132186360",
	scroll = "rbxassetid://114127804740858",
	menu = "rbxassetid://6340513838",
	crosshair = "rbxassetid://12614416478",
	user = "rbxassetid://108483430622128",
	stat = "rbxassetid://12094445329",
	eyes = "rbxassetid://14321059114",
	sword = "rbxassetid://82472368671405",
	discord = "rbxassetid://94434236999817",
	star = "rbxassetid://107005941750079",
	skeleton = "rbxassetid://17313330026",
	payment = "rbxassetid://18747025078",
	scan = "rbxassetid://109869955247116",
	alert = "rbxassetid://73186275216515",
	question = "rbxassetid://17510196486",
	idea = "rbxassetid://16833255748",
	strom = "rbxassetid://13321880293",
	water = "rbxassetid://100076212630732",
	dcs = "rbxassetid://15310731934",
	start = "rbxassetid://108886429866687",
	next = "rbxassetid://12662718374",
	rod = "rbxassetid://103247953194129",
	fish = "rbxassetid://97167558235554",
}

local function isMobileDevice()
	return UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled and not UserInputService.MouseEnabled
end
local isMobile = isMobileDevice()

local function MakeDraggable(handle, frame)
	local dragging, dragInput, dragStart, startPos
	handle.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			dragging = true
			dragStart = input.Position
			startPos = frame.Position
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then dragging = false end
			end)
		end
	end)
	handle.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
			dragInput = input
		end
	end)
	UserInputService.InputChanged:Connect(function(input)
		if input == dragInput and dragging then
			local d = input.Position - dragStart
			TweenService:Create(frame, TweenInfo.new(0.06), {
				Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + d.X, startPos.Y.Scale, startPos.Y.Offset + d.Y)
			}):Play()
		end
	end)
end

local function Notify(msg, dur, col)
	task.spawn(function()
		if not CoreGui:FindFirstChild("OrionNotify") then
			local g = Instance.new("ScreenGui")
			g.Name = "OrionNotify"
			g.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
			g.Parent = CoreGui
			local h = Instance.new("Frame")
			h.Name = "Holder"
			h.AnchorPoint = Vector2.new(1, 1)
			h.Position = UDim2.new(1, -16, 1, -16)
			h.Size = UDim2.new(0, 260, 1, 0)
			h.BackgroundTransparency = 1
			h.Parent = g
			local l = Instance.new("UIListLayout")
			l.VerticalAlignment = Enum.VerticalAlignment.Bottom
			l.Padding = UDim.new(0, 6)
			l.SortOrder = Enum.SortOrder.LayoutOrder
			l.Parent = h
		end

		local holder = CoreGui.OrionNotify.Holder
		local nf = Instance.new("Frame")
		nf.Size = UDim2.new(1, 0, 0, 44)
		nf.BackgroundColor3 = Color3.fromRGB(22, 22, 26)
		nf.BorderSizePixel = 0
		nf.ClipsDescendants = true
		nf.Parent = holder
		Instance.new("UICorner", nf).CornerRadius = UDim.new(0, 8)

		local st = Instance.new("UIStroke")
		st.Color = Color3.fromRGB(45, 45, 50)
		st.Thickness = 1
		st.Parent = nf

		local ac = Instance.new("Frame")
		ac.Size = UDim2.new(0, 3, 1, 0)
		ac.BackgroundColor3 = col or Color3.fromRGB(130, 80, 255)
		ac.BorderSizePixel = 0
		ac.Parent = nf

		local tl = Instance.new("TextLabel")
		tl.Font = Enum.Font.GothamBold
		tl.Text = "Orion"
		tl.TextSize = 11
		tl.TextColor3 = Color3.fromRGB(130, 80, 255)
		tl.TextXAlignment = Enum.TextXAlignment.Left
		tl.BackgroundTransparency = 1
		tl.Position = UDim2.new(0, 14, 0, 6)
		tl.Size = UDim2.new(1, -20, 0, 12)
		tl.Parent = nf

		local ml = Instance.new("TextLabel")
		ml.Font = Enum.Font.Gotham
		ml.Text = msg or ""
		ml.TextSize = 11
		ml.TextColor3 = Color3.fromRGB(170, 170, 175)
		ml.TextXAlignment = Enum.TextXAlignment.Left
		ml.TextWrapped = true
		ml.BackgroundTransparency = 1
		ml.Position = UDim2.new(0, 14, 0, 22)
		ml.Size = UDim2.new(1, -20, 0, 16)
		ml.Parent = nf

		nf.Position = UDim2.new(1, 280, 0, 0)
		TweenService:Create(nf, TweenInfo.new(0.3, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), { Position = UDim2.new(0, 0, 0, 0) }):Play()

		task.wait(dur or 3)

		TweenService:Create(nf, TweenInfo.new(0.3, Enum.EasingStyle.Quart, Enum.EasingDirection.In), { Position = UDim2.new(1, 280, 0, 0) }):Play()
		task.wait(0.35)
		nf:Destroy()
	end)
end

local Orion = {}

function Orion:MakeNotify(cfg)
	cfg = cfg or {}
	Notify(cfg.Content or cfg.Description or "", cfg.Delay or 3, cfg.Color)
end

function Orion:Window(GuiConfig)
	GuiConfig = GuiConfig or {}
	GuiConfig.Title = GuiConfig.Title or "Orion"
	GuiConfig.Footer = GuiConfig.Footer or ""
	GuiConfig.Color = GuiConfig.Color or Color3.fromRGB(130, 80, 255)
	GuiConfig["Tab Width"] = GuiConfig["Tab Width"] or 150
	GuiConfig.Version = GuiConfig.Version or 1

	local folderName = GuiConfig.Folder or GuiConfig.Title:gsub("[^%w_ ]", ""):gsub("%s+", "_")
	gameFolder = "Orion/" .. folderName
	AutoloadFile = gameFolder .. "/autoload.txt"
	if not isfolder(gameFolder) then makefolder(gameFolder) end
	CURRENT_VERSION = GuiConfig.Version

	local autoloadName = GetAutoload()
	if autoloadName then LoadConfig(autoloadName)
	else ConfigData = { _version = CURRENT_VERSION } end

	local GuiFunc = {}
	local Accent = GuiConfig.Color
	local TabW = GuiConfig["Tab Width"]
	local W = isMobile and 460 or 580
	local H = isMobile and 310 or 400

	if CoreGui:FindFirstChild("OrionUI") then CoreGui.OrionUI:Destroy() end
	if CoreGui:FindFirstChild("OrionToggle") then CoreGui.OrionToggle:Destroy() end

	local ScreenGui = Instance.new("ScreenGui")
	ScreenGui.Name = "OrionUI"
	ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
	ScreenGui.ResetOnSpawn = false
	ScreenGui.Parent = CoreGui

	local Shadow = Instance.new("ImageLabel")
	Shadow.Name = "Shadow"
	Shadow.Image = "rbxassetid://6015897843"
	Shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
	Shadow.ImageTransparency = 0.5
	Shadow.ScaleType = Enum.ScaleType.Slice
	Shadow.SliceCenter = Rect.new(49, 49, 450, 450)
	Shadow.AnchorPoint = Vector2.new(0.5, 0.5)
	Shadow.BackgroundTransparency = 1
	Shadow.Position = UDim2.new(0.5, 0, 0.5, 0)
	Shadow.Size = UDim2.new(0, W + 40, 0, H + 40)
	Shadow.Parent = ScreenGui

	local Main = Instance.new("Frame")
	Main.Name = "Main"
	Main.AnchorPoint = Vector2.new(0.5, 0.5)
	Main.Position = UDim2.new(0.5, 0, 0.5, 0)
	Main.Size = UDim2.new(0, W, 0, H)
	Main.BackgroundColor3 = Color3.fromRGB(16, 16, 20)
	Main.BorderSizePixel = 0
	Main.ClipsDescendants = true
	Main.Parent = Shadow
	Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 8)

	local MainStroke = Instance.new("UIStroke")
	MainStroke.Color = Color3.fromRGB(38, 38, 44)
	MainStroke.Thickness = 1
	MainStroke.Parent = Main

	MakeDraggable(Main, Shadow)

	local Sidebar = Instance.new("Frame")
	Sidebar.Name = "Sidebar"
	Sidebar.Size = UDim2.new(0, TabW, 1, 0)
	Sidebar.BackgroundColor3 = Color3.fromRGB(12, 12, 15)
	Sidebar.BorderSizePixel = 0
	Sidebar.ZIndex = 2
	Sidebar.Parent = Main

	local SideCorner = Instance.new("Frame")
	SideCorner.Size = UDim2.new(0, 8, 1, 0)
	SideCorner.Position = UDim2.new(1, -8, 0, 0)
	SideCorner.BackgroundColor3 = Color3.fromRGB(12, 12, 15)
	SideCorner.BorderSizePixel = 0
	SideCorner.ZIndex = 2
	SideCorner.Parent = Sidebar

	Instance.new("UICorner", Sidebar).CornerRadius = UDim.new(0, 8)

	local SideDivider = Instance.new("Frame")
	SideDivider.Size = UDim2.new(0, 1, 1, 0)
	SideDivider.Position = UDim2.new(0, TabW, 0, 0)
	SideDivider.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
	SideDivider.BorderSizePixel = 0
	SideDivider.ZIndex = 3
	SideDivider.Parent = Main

	local LogoHolder = Instance.new("Frame")
	LogoHolder.Size = UDim2.new(1, 0, 0, 50)
	LogoHolder.BackgroundTransparency = 1
	LogoHolder.ZIndex = 3
	LogoHolder.Parent = Sidebar

	local LogoImg = Instance.new("ImageLabel")
	LogoImg.Size = UDim2.new(0, 26, 0, 26)
	LogoImg.Position = UDim2.new(0, 14, 0, 12)
	LogoImg.BackgroundTransparency = 1
	LogoImg.Image = "rbxassetid://128370480474724"
	LogoImg.ScaleType = Enum.ScaleType.Fit
	LogoImg.ZIndex = 4
	LogoImg.Parent = LogoHolder

	local TitleLbl = Instance.new("TextLabel")
	TitleLbl.Font = Enum.Font.GothamBold
	TitleLbl.Text = GuiConfig.Title
	TitleLbl.TextSize = 16
	TitleLbl.TextColor3 = Accent
	TitleLbl.TextXAlignment = Enum.TextXAlignment.Left
	TitleLbl.BackgroundTransparency = 1
	TitleLbl.Position = UDim2.new(0, 46, 0, 12)
	TitleLbl.Size = UDim2.new(1, -52, 0, 26)
	TitleLbl.ZIndex = 4
	TitleLbl.Parent = LogoHolder

	local TabScroll = Instance.new("ScrollingFrame")
	TabScroll.Name = "TabScroll"
	TabScroll.Position = UDim2.new(0, 0, 0, 52)
	TabScroll.Size = UDim2.new(1, 0, 1, -52)
	TabScroll.BackgroundTransparency = 1
	TabScroll.ScrollBarThickness = 0
	TabScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
	TabScroll.BorderSizePixel = 0
	TabScroll.ZIndex = 3
	TabScroll.Parent = Sidebar

	local TabListLayout = Instance.new("UIListLayout")
	TabListLayout.Padding = UDim.new(0, 2)
	TabListLayout.SortOrder = Enum.SortOrder.LayoutOrder
	TabListLayout.Parent = TabScroll

	local TabPad = Instance.new("UIPadding")
	TabPad.PaddingLeft = UDim.new(0, 6)
	TabPad.PaddingRight = UDim.new(0, 6)
	TabPad.PaddingTop = UDim.new(0, 4)
	TabPad.Parent = TabScroll

	TabListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
		TabScroll.CanvasSize = UDim2.new(0, 0, 0, TabListLayout.AbsoluteContentSize.Y + 12)
	end)

	local ContentHolder = Instance.new("Frame")
	ContentHolder.Name = "Content"
	ContentHolder.Position = UDim2.new(0, TabW + 1, 0, 0)
	ContentHolder.Size = UDim2.new(1, -(TabW + 1), 1, 0)
	ContentHolder.BackgroundTransparency = 1
	ContentHolder.ClipsDescendants = true
	ContentHolder.Parent = Main

	local AllPages = {}
	local ActivePage = nil

	local function switchPage(idx)
		for i, page in pairs(AllPages) do
			if i == idx then
				if ActivePage == page then return end
				page.Visible = true
				page.Position = UDim2.new(0, 0, 0.03, 0)
				page.GroupTransparency = 1

				local pg = page:FindFirstChildWhichIsA("CanvasGroup") or page
				TweenService:Create(page, TweenInfo.new(0.25, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {
					Position = UDim2.new(0, 0, 0, 0),
					GroupTransparency = 0
				}):Play()

				ActivePage = page
			else
				if page.Visible and page ~= ActivePage then
					task.spawn(function()
						TweenService:Create(page, TweenInfo.new(0.15, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
							GroupTransparency = 1
						}):Play()
						task.wait(0.15)
						if AllPages[idx] ~= page then
							page.Visible = false
						end
					end)
				else
					page.Visible = false
				end
			end
		end
	end

	local Indicator = Instance.new("Frame")
	Indicator.Name = "Indicator"
	Indicator.Size = UDim2.new(0, 3, 0, 18)
	Indicator.Position = UDim2.new(0, 3, 0, 60)
	Indicator.BackgroundColor3 = Accent
	Indicator.BorderSizePixel = 0
	Indicator.ZIndex = 5
	Indicator.Parent = Sidebar
	Instance.new("UICorner", Indicator).CornerRadius = UDim.new(0, 2)

	local DropOverlay = Instance.new("TextButton")
	DropOverlay.Name = "DropOverlay"
	DropOverlay.Size = UDim2.new(1, 0, 1, 0)
	DropOverlay.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	DropOverlay.BackgroundTransparency = 1
	DropOverlay.Text = ""
	DropOverlay.AutoButtonColor = false
	DropOverlay.Visible = false
	DropOverlay.ZIndex = 80
	DropOverlay.Parent = Main

	local DropPanel = Instance.new("Frame")
	DropPanel.Name = "DropPanel"
	DropPanel.AnchorPoint = Vector2.new(0.5, 0.5)
	DropPanel.Position = UDim2.new(0.5, 0, 0.5, 0)
	DropPanel.Size = UDim2.new(0, 200, 0, 240)
	DropPanel.BackgroundColor3 = Color3.fromRGB(20, 20, 24)
	DropPanel.BorderSizePixel = 0
	DropPanel.ZIndex = 81
	DropPanel.Visible = false
	DropPanel.ClipsDescendants = true
	DropPanel.Parent = Main
	Instance.new("UICorner", DropPanel).CornerRadius = UDim.new(0, 8)

	local dpStroke = Instance.new("UIStroke")
	dpStroke.Color = Color3.fromRGB(50, 50, 56)
	dpStroke.Thickness = 1
	dpStroke.Parent = DropPanel

	local dpTitle = Instance.new("TextLabel")
	dpTitle.Name = "Title"
	dpTitle.Font = Enum.Font.GothamBold
	dpTitle.Text = "Select"
	dpTitle.TextSize = 12
	dpTitle.TextColor3 = Color3.fromRGB(200, 200, 205)
	dpTitle.TextXAlignment = Enum.TextXAlignment.Left
	dpTitle.BackgroundTransparency = 1
	dpTitle.Position = UDim2.new(0, 12, 0, 8)
	dpTitle.Size = UDim2.new(1, -40, 0, 18)
	dpTitle.ZIndex = 82
	dpTitle.Parent = DropPanel

	local dpClose = Instance.new("TextButton")
	dpClose.Text = "âœ•"
	dpClose.Font = Enum.Font.GothamBold
	dpClose.TextSize = 13
	dpClose.TextColor3 = Color3.fromRGB(100, 100, 105)
	dpClose.BackgroundTransparency = 1
	dpClose.AnchorPoint = Vector2.new(1, 0)
	dpClose.Position = UDim2.new(1, -4, 0, 4)
	dpClose.Size = UDim2.new(0, 24, 0, 24)
	dpClose.ZIndex = 82
	dpClose.Parent = DropPanel

	local dpSearch = Instance.new("TextBox")
	dpSearch.Font = Enum.Font.Gotham
	dpSearch.PlaceholderText = "Search..."
	dpSearch.PlaceholderColor3 = Color3.fromRGB(60, 60, 65)
	dpSearch.Text = ""
	dpSearch.TextSize = 11
	dpSearch.TextColor3 = Color3.fromRGB(190, 190, 195)
	dpSearch.BackgroundColor3 = Color3.fromRGB(28, 28, 32)
	dpSearch.BorderSizePixel = 0
	dpSearch.Position = UDim2.new(0, 8, 0, 32)
	dpSearch.Size = UDim2.new(1, -16, 0, 26)
	dpSearch.ClearTextOnFocus = false
	dpSearch.ZIndex = 82
	dpSearch.Parent = DropPanel
	Instance.new("UICorner", dpSearch).CornerRadius = UDim.new(0, 4)

	local dpPad = Instance.new("UIPadding")
	dpPad.PaddingLeft = UDim.new(0, 6)
	dpPad.Parent = dpSearch

	local dpScroll = Instance.new("ScrollingFrame")
	dpScroll.Position = UDim2.new(0, 6, 0, 64)
	dpScroll.Size = UDim2.new(1, -12, 1, -70)
	dpScroll.BackgroundTransparency = 1
	dpScroll.ScrollBarThickness = 2
	dpScroll.ScrollBarImageColor3 = Color3.fromRGB(55, 55, 60)
	dpScroll.BorderSizePixel = 0
	dpScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
	dpScroll.ZIndex = 82
	dpScroll.Parent = DropPanel

	local dpListLayout = Instance.new("UIListLayout")
	dpListLayout.Padding = UDim.new(0, 2)
	dpListLayout.SortOrder = Enum.SortOrder.LayoutOrder
	dpListLayout.Parent = dpScroll

	dpListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
		dpScroll.CanvasSize = UDim2.new(0, 0, 0, dpListLayout.AbsoluteContentSize.Y)
	end)

	local activeDropRef = nil

	local function closeDropdown()
		TweenService:Create(DropOverlay, TweenInfo.new(0.15), { BackgroundTransparency = 1 }):Play()
		TweenService:Create(DropPanel, TweenInfo.new(0.2, Enum.EasingStyle.Quart, Enum.EasingDirection.In), {
			Size = UDim2.new(0, 200, 0, 0)
		}):Play()
		task.delay(0.2, function()
			DropOverlay.Visible = false
			DropPanel.Visible = false
			DropPanel.Size = UDim2.new(0, 200, 0, 240)
			dpSearch.Text = ""
			for _, c in dpScroll:GetChildren() do
				if c:IsA("Frame") then c:Destroy() end
			end
			activeDropRef = nil
		end)
	end

	local function openDropdownPanel(title, options, dropFunc, multi)
		dpTitle.Text = title
		dpSearch.Text = ""
		activeDropRef = dropFunc

		for _, c in dpScroll:GetChildren() do
			if c:IsA("Frame") then c:Destroy() end
		end

		for i, opt in ipairs(options) do
			local label, value
			if typeof(opt) == "table" and opt.Label then
				label = tostring(opt.Label)
				value = opt.Value
			else
				label = tostring(opt)
				value = opt
			end

			local of = Instance.new("Frame")
			of.Name = "Opt"
			of.Size = UDim2.new(1, 0, 0, 28)
			of.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
			of.BackgroundTransparency = 1
			of.BorderSizePixel = 0
			of.LayoutOrder = i
			of.ZIndex = 83
			of.Parent = dpScroll
			Instance.new("UICorner", of).CornerRadius = UDim.new(0, 4)
			of:SetAttribute("Val", value)

			local ob = Instance.new("TextButton")
			ob.Text = ""
			ob.Size = UDim2.new(1, 0, 1, 0)
			ob.BackgroundTransparency = 1
			ob.ZIndex = 84
			ob.Parent = of

			local ol = Instance.new("TextLabel")
			ol.Name = "Label"
			ol.Font = Enum.Font.Gotham
			ol.Text = label
			ol.TextSize = 12
			ol.TextColor3 = Color3.fromRGB(180, 180, 185)
			ol.TextXAlignment = Enum.TextXAlignment.Left
			ol.BackgroundTransparency = 1
			ol.Position = UDim2.new(0, 10, 0, 0)
			ol.Size = UDim2.new(1, -30, 1, 0)
			ol.ZIndex = 83
			ol.Parent = of

			local ck = Instance.new("Frame")
			ck.Name = "Check"
			ck.AnchorPoint = Vector2.new(1, 0.5)
			ck.Position = UDim2.new(1, -8, 0.5, 0)
			ck.Size = UDim2.new(0, 8, 0, 8)
			ck.BackgroundColor3 = Accent
			ck.BorderSizePixel = 0
			ck.ZIndex = 83
			ck.Visible = false
			ck.Parent = of
			Instance.new("UICorner", ck).CornerRadius = UDim.new(1, 0)

			local sel = false
			if multi then
				sel = table.find(dropFunc.Value, value) ~= nil
			else
				sel = (dropFunc.Value == value)
			end
			ck.Visible = sel
			of.BackgroundTransparency = sel and 0.4 or 1

			ob.MouseButton1Click:Connect(function()
				if multi then
					local idx2 = table.find(dropFunc.Value, value)
					if idx2 then table.remove(dropFunc.Value, idx2) else table.insert(dropFunc.Value, value) end
				else
					dropFunc.Value = value
				end

				for _, cf in dpScroll:GetChildren() do
					if cf:IsA("Frame") and cf:FindFirstChild("Check") then
						local cv = cf:GetAttribute("Val")
						local isSel = multi and (table.find(dropFunc.Value, cv) ~= nil) or (dropFunc.Value == cv)
						cf.Check.Visible = isSel
						TweenService:Create(cf, TweenInfo.new(0.12), { BackgroundTransparency = isSel and 0.4 or 1 }):Play()
					end
				end

				dropFunc:_apply()

				if not multi then
					closeDropdown()
				end
			end)
		end

		DropOverlay.Visible = true
		DropOverlay.BackgroundTransparency = 1
		TweenService:Create(DropOverlay, TweenInfo.new(0.2), { BackgroundTransparency = 0.4 }):Play()

		DropPanel.Visible = true
		DropPanel.Size = UDim2.new(0, 200, 0, 0)
		TweenService:Create(DropPanel, TweenInfo.new(0.25, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {
			Size = UDim2.new(0, 200, 0, 240)
		}):Play()
	end

	dpClose.MouseButton1Click:Connect(closeDropdown)
	DropOverlay.MouseButton1Click:Connect(closeDropdown)

	dpSearch:GetPropertyChangedSignal("Text"):Connect(function()
		local q = string.lower(dpSearch.Text)
		for _, c in dpScroll:GetChildren() do
			if c:IsA("Frame") and c:FindFirstChild("Label") then
				c.Visible = q == "" or string.find(string.lower(c.Label.Text), q, 1, true) ~= nil
			end
		end
	end)

	UserInputService.InputBegan:Connect(function(input, gpe)
		if gpe then return end
		if input.KeyCode == Enum.KeyCode.F3 then
			Shadow.Visible = not Shadow.Visible
		end
	end)

	function GuiFunc:DestroyGui()
		ScreenGui:Destroy()
		if CoreGui:FindFirstChild("OrionToggle") then CoreGui.OrionToggle:Destroy() end
	end

	local BtnGui = Instance.new("ScreenGui")
	BtnGui.Name = "OrionToggle"
	BtnGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
	BtnGui.ResetOnSpawn = false
	BtnGui.Parent = CoreGui

	local TogBtn = Instance.new("ImageButton")
	TogBtn.Size = UDim2.new(0, 34, 0, 34)
	TogBtn.Position = UDim2.new(0, 14, 0, 100)
	TogBtn.BackgroundColor3 = Color3.fromRGB(18, 18, 22)
	TogBtn.BorderSizePixel = 0
	TogBtn.AutoButtonColor = false
	TogBtn.Image = "rbxassetid://128370480474724"
	TogBtn.ScaleType = Enum.ScaleType.Fit
	TogBtn.Parent = BtnGui
	Instance.new("UICorner", TogBtn).CornerRadius = UDim.new(0, 8)
	local tbs = Instance.new("UIStroke")
	tbs.Color = Color3.fromRGB(45, 45, 50)
	tbs.Thickness = 1
	tbs.Parent = TogBtn

	TogBtn.MouseButton1Click:Connect(function()
		Shadow.Visible = not Shadow.Visible
	end)

	do
		local dr2, ds2, sp2
		TogBtn.InputBegan:Connect(function(input)
			if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
				dr2 = true
				ds2 = input.Position
				sp2 = TogBtn.Position
				input.Changed:Connect(function()
					if input.UserInputState == Enum.UserInputState.End then dr2 = false end
				end)
			end
		end)
		UserInputService.InputChanged:Connect(function(input)
			if dr2 and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
				local d = input.Position - ds2
				TogBtn.Position = UDim2.new(sp2.X.Scale, sp2.X.Offset + d.X, sp2.Y.Scale, sp2.Y.Offset + d.Y)
			end
		end)
	end

	local Tabs = {}
	local CountTab = 0
	local AllTabBtns = {}

	function Tabs:AddTab(TabConfig)
		TabConfig = TabConfig or {}
		TabConfig.Name = TabConfig.Name or "Tab"
		TabConfig.Icon = TabConfig.Icon or ""

		local tabIdx = CountTab

		local Page = Instance.new("CanvasGroup")
		Page.Name = "Page_" .. tabIdx
		Page.Size = UDim2.new(1, 0, 1, 0)
		Page.BackgroundTransparency = 1
		Page.BorderSizePixel = 0
		Page.Visible = false
		Page.GroupTransparency = 1
		Page.Parent = ContentHolder

		local PageScroll = Instance.new("ScrollingFrame")
		PageScroll.Size = UDim2.new(1, 0, 1, 0)
		PageScroll.BackgroundTransparency = 1
		PageScroll.ScrollBarThickness = 2
		PageScroll.ScrollBarImageColor3 = Color3.fromRGB(50, 50, 55)
		PageScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
		PageScroll.BorderSizePixel = 0
		PageScroll.Parent = Page

		local PagePad = Instance.new("UIPadding")
		PagePad.PaddingLeft = UDim.new(0, 12)
		PagePad.PaddingRight = UDim.new(0, 12)
		PagePad.PaddingTop = UDim.new(0, 8)
		PagePad.PaddingBottom = UDim.new(0, 8)
		PagePad.Parent = PageScroll

		local PLayout = Instance.new("UIListLayout")
		PLayout.Padding = UDim.new(0, 4)
		PLayout.SortOrder = Enum.SortOrder.LayoutOrder
		PLayout.Parent = PageScroll

		PLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
			PageScroll.CanvasSize = UDim2.new(0, 0, 0, PLayout.AbsoluteContentSize.Y + 16)
		end)

		AllPages[tabIdx] = Page

		local TabBtn = Instance.new("TextButton")
		TabBtn.Name = "Tab_" .. tabIdx
		TabBtn.LayoutOrder = tabIdx
		TabBtn.Size = UDim2.new(1, 0, 0, 32)
		TabBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
		TabBtn.BackgroundTransparency = 1
		TabBtn.Text = ""
		TabBtn.AutoButtonColor = false
		TabBtn.BorderSizePixel = 0
		TabBtn.ZIndex = 4
		TabBtn.Parent = TabScroll
		Instance.new("UICorner", TabBtn).CornerRadius = UDim.new(0, 6)

		local TIcon = Instance.new("ImageLabel")
		TIcon.Size = UDim2.new(0, 16, 0, 16)
		TIcon.Position = UDim2.new(0, 10, 0.5, -8)
		TIcon.BackgroundTransparency = 1
		TIcon.ImageColor3 = Color3.fromRGB(120, 120, 125)
		TIcon.ZIndex = 5
		TIcon.Parent = TabBtn
		if TabConfig.Icon ~= "" then
			TIcon.Image = Icons[TabConfig.Icon] or TabConfig.Icon
		end

		local TName = Instance.new("TextLabel")
		TName.Font = Enum.Font.GothamBold
		TName.Text = TabConfig.Name
		TName.TextSize = 12
		TName.TextColor3 = Color3.fromRGB(120, 120, 125)
		TName.TextXAlignment = Enum.TextXAlignment.Left
		TName.BackgroundTransparency = 1
		TName.Position = UDim2.new(0, 34, 0, 0)
		TName.Size = UDim2.new(1, -38, 1, 0)
		TName.ZIndex = 5
		TName.Parent = TabBtn

		AllTabBtns[tabIdx] = { Btn = TabBtn, Name = TName, Icon = TIcon }

		TabBtn.MouseButton1Click:Connect(function()
			for i, tb in pairs(AllTabBtns) do
				if i == tabIdx then
					TweenService:Create(tb.Name, TweenInfo.new(0.18), { TextColor3 = Accent }):Play()
					TweenService:Create(tb.Icon, TweenInfo.new(0.18), { ImageColor3 = Accent }):Play()
					TweenService:Create(tb.Btn, TweenInfo.new(0.18), { BackgroundTransparency = 0.92 }):Play()
				else
					TweenService:Create(tb.Name, TweenInfo.new(0.18), { TextColor3 = Color3.fromRGB(120, 120, 125) }):Play()
					TweenService:Create(tb.Icon, TweenInfo.new(0.18), { ImageColor3 = Color3.fromRGB(120, 120, 125) }):Play()
					TweenService:Create(tb.Btn, TweenInfo.new(0.18), { BackgroundTransparency = 1 }):Play()
				end
			end

			local targetY = 60 + (tabIdx * 34)
			TweenService:Create(Indicator, TweenInfo.new(0.22, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {
				Position = UDim2.new(0, 3, 0, targetY)
			}):Play()

			switchPage(tabIdx)
		end)

		if CountTab == 0 then
			task.defer(function()
				local tb = AllTabBtns[0]
				tb.Name.TextColor3 = Accent
				tb.Icon.ImageColor3 = Accent
				tb.Btn.BackgroundTransparency = 0.92
				AllPages[0].Visible = true
				AllPages[0].GroupTransparency = 0
				ActivePage = AllPages[0]
			end)
		end

		local Sections = {}
		local CountSection = 0

		function Sections:AddSection(STitle, AlwaysOpen)
			STitle = STitle or "Section"
			local secIdx = CountSection

			local Section = Instance.new("Frame")
			Section.Name = "Section"
			Section.LayoutOrder = secIdx
			Section.BackgroundTransparency = 1
			Section.Size = UDim2.new(1, 0, 0, 26)
			Section.ClipsDescendants = true
			Section.Parent = PageScroll

			local Header = Instance.new("TextButton")
			Header.Size = UDim2.new(1, 0, 0, 24)
			Header.BackgroundTransparency = 1
			Header.Text = ""
			Header.AutoButtonColor = false
			Header.Parent = Section

			local SLabel = Instance.new("TextLabel")
			SLabel.Font = Enum.Font.GothamBold
			SLabel.Text = STitle
			SLabel.TextSize = 12
			SLabel.TextColor3 = Color3.fromRGB(85, 85, 92)
			SLabel.TextXAlignment = Enum.TextXAlignment.Left
			SLabel.BackgroundTransparency = 1
			SLabel.Position = UDim2.new(0, 2, 0, 0)
			SLabel.Size = UDim2.new(1, -24, 1, 0)
			SLabel.Parent = Header

			local Arrow = Instance.new("ImageLabel")
			Arrow.Size = UDim2.new(0, 12, 0, 12)
			Arrow.AnchorPoint = Vector2.new(1, 0.5)
			Arrow.Position = UDim2.new(1, 0, 0.5, 0)
			Arrow.BackgroundTransparency = 1
			Arrow.Image = "rbxassetid://16851841101"
			Arrow.ImageColor3 = Color3.fromRGB(70, 70, 75)
			Arrow.Rotation = -90
			Arrow.Parent = Header

			local ItemHolder = Instance.new("Frame")
			ItemHolder.Name = "Items"
			ItemHolder.Position = UDim2.new(0, 0, 0, 28)
			ItemHolder.Size = UDim2.new(1, 0, 0, 0)
			ItemHolder.BackgroundTransparency = 1
			ItemHolder.Parent = Section

			local ILayout = Instance.new("UIListLayout")
			ILayout.Padding = UDim.new(0, 3)
			ILayout.SortOrder = Enum.SortOrder.LayoutOrder
			ILayout.Parent = ItemHolder

			local isOpen = false

			local function updateSize()
				if isOpen then
					local th = 0
					for _, c in ItemHolder:GetChildren() do
						if c:IsA("GuiObject") then th = th + c.Size.Y.Offset + 3 end
					end
					TweenService:Create(ItemHolder, TweenInfo.new(0.2), { Size = UDim2.new(1, 0, 0, th) }):Play()
					TweenService:Create(Section, TweenInfo.new(0.2), { Size = UDim2.new(1, 0, 0, 28 + th) }):Play()
				else
					TweenService:Create(ItemHolder, TweenInfo.new(0.15), { Size = UDim2.new(1, 0, 0, 0) }):Play()
					TweenService:Create(Section, TweenInfo.new(0.15), { Size = UDim2.new(1, 0, 0, 26) }):Play()
				end
			end

			local function open()
				isOpen = true
				TweenService:Create(Arrow, TweenInfo.new(0.15), { Rotation = 0 }):Play()
				TweenService:Create(SLabel, TweenInfo.new(0.15), { TextColor3 = Color3.fromRGB(150, 150, 158) }):Play()
				updateSize()
			end

			local function close()
				isOpen = false
				TweenService:Create(Arrow, TweenInfo.new(0.15), { Rotation = -90 }):Play()
				TweenService:Create(SLabel, TweenInfo.new(0.15), { TextColor3 = Color3.fromRGB(85, 85, 92) }):Play()
				updateSize()
			end

			if AlwaysOpen == true then
				Arrow.Visible = false
				isOpen = true
				task.defer(function()
					local th = 0
					for _, c in ItemHolder:GetChildren() do
						if c:IsA("GuiObject") then th = th + c.Size.Y.Offset + 3 end
					end
					ItemHolder.Size = UDim2.new(1, 0, 0, th)
					Section.Size = UDim2.new(1, 0, 0, 28 + th)
					SLabel.TextColor3 = Color3.fromRGB(150, 150, 158)
				end)
			elseif AlwaysOpen == false then
				open()
			end

			if AlwaysOpen ~= true then
				Header.MouseButton1Click:Connect(function()
					if isOpen then close() else open() end
				end)
			end

			ItemHolder.ChildAdded:Connect(function() task.defer(updateSize) end)
			ItemHolder.ChildRemoved:Connect(function() task.defer(updateSize) end)

			local Items = {}
			local CountItem = 0

			function Items:AddToggle(cfg)
				cfg = cfg or {}
				cfg.Title = cfg.Title or "Toggle"
				cfg.Default = cfg.Default or false
				cfg.Callback = cfg.Callback or function() end

				local ck = "Toggle_" .. cfg.Title
				if ConfigData[ck] ~= nil then cfg.Default = ConfigData[ck] end

				local F = { Value = cfg.Default }

				local fr = Instance.new("Frame")
				fr.Size = UDim2.new(1, 0, 0, 36)
				fr.BackgroundColor3 = Color3.fromRGB(22, 22, 27)
				fr.BorderSizePixel = 0
				fr.LayoutOrder = CountItem
				fr.Parent = ItemHolder
				Instance.new("UICorner", fr).CornerRadius = UDim.new(0, 6)

				local btn = Instance.new("TextButton")
				btn.Text = ""
				btn.Size = UDim2.new(1, 0, 1, 0)
				btn.BackgroundTransparency = 1
				btn.Parent = fr

				local tl = Instance.new("TextLabel")
				tl.Font = Enum.Font.GothamBold
				tl.Text = cfg.Title
				tl.TextSize = 13
				tl.TextColor3 = Color3.fromRGB(205, 205, 210)
				tl.TextXAlignment = Enum.TextXAlignment.Left
				tl.BackgroundTransparency = 1
				tl.Position = UDim2.new(0, 14, 0, 0)
				tl.Size = UDim2.new(1, -66, 1, 0)
				tl.Parent = fr

				local sb = Instance.new("Frame")
				sb.AnchorPoint = Vector2.new(1, 0.5)
				sb.Position = UDim2.new(1, -12, 0.5, 0)
				sb.Size = UDim2.new(0, 34, 0, 18)
				sb.BackgroundColor3 = Color3.fromRGB(40, 40, 46)
				sb.BorderSizePixel = 0
				sb.Parent = fr
				Instance.new("UICorner", sb).CornerRadius = UDim.new(1, 0)

				local sc = Instance.new("Frame")
				sc.Size = UDim2.new(0, 14, 0, 14)
				sc.Position = UDim2.new(0, 2, 0, 2)
				sc.BackgroundColor3 = Color3.fromRGB(75, 75, 80)
				sc.BorderSizePixel = 0
				sc.Parent = sb
				Instance.new("UICorner", sc).CornerRadius = UDim.new(1, 0)

				function F:Set(val)
					F.Value = val
					ConfigData[ck] = val
					if val then
						TweenService:Create(sb, TweenInfo.new(0.18), { BackgroundColor3 = Accent }):Play()
						TweenService:Create(sc, TweenInfo.new(0.18), { Position = UDim2.new(0, 18, 0, 2), BackgroundColor3 = Color3.fromRGB(255, 255, 255) }):Play()
					else
						TweenService:Create(sb, TweenInfo.new(0.18), { BackgroundColor3 = Color3.fromRGB(40, 40, 46) }):Play()
						TweenService:Create(sc, TweenInfo.new(0.18), { Position = UDim2.new(0, 2, 0, 2), BackgroundColor3 = Color3.fromRGB(75, 75, 80) }):Play()
					end
					pcall(cfg.Callback, val)
				end

				btn.MouseButton1Click:Connect(function()
					F.Value = not F.Value
					F:Set(F.Value)
				end)

				F:Set(F.Value)
				CountItem += 1
				Elements[ck] = F
				return F
			end

			function Items:AddDropdown(cfg)
				cfg = cfg or {}
				cfg.Title = cfg.Title or "Dropdown"
				cfg.Multi = cfg.Multi or false
				cfg.Options = cfg.Options or {}
				cfg.Default = cfg.Default or (cfg.Multi and {} or nil)
				cfg.Callback = cfg.Callback or function() end

				local ck = "Dropdown_" .. cfg.Title
				if ConfigData[ck] ~= nil then cfg.Default = ConfigData[ck] end

				local F = { Value = cfg.Default, Options = cfg.Options }

				local fr = Instance.new("Frame")
				fr.Size = UDim2.new(1, 0, 0, 36)
				fr.BackgroundColor3 = Color3.fromRGB(22, 22, 27)
				fr.BorderSizePixel = 0
				fr.LayoutOrder = CountItem
				fr.Parent = ItemHolder
				Instance.new("UICorner", fr).CornerRadius = UDim.new(0, 6)

				local dbtn = Instance.new("TextButton")
				dbtn.Text = ""
				dbtn.Size = UDim2.new(1, 0, 1, 0)
				dbtn.BackgroundTransparency = 1
				dbtn.Parent = fr

				local dtl = Instance.new("TextLabel")
				dtl.Font = Enum.Font.GothamBold
				dtl.Text = cfg.Title
				dtl.TextSize = 13
				dtl.TextColor3 = Color3.fromRGB(205, 205, 210)
				dtl.TextXAlignment = Enum.TextXAlignment.Left
				dtl.BackgroundTransparency = 1
				dtl.Position = UDim2.new(0, 14, 0, 0)
				dtl.Size = UDim2.new(0.45, 0, 1, 0)
				dtl.Parent = fr

				local sf = Instance.new("Frame")
				sf.AnchorPoint = Vector2.new(1, 0.5)
				sf.Position = UDim2.new(1, -10, 0.5, 0)
				sf.Size = UDim2.new(0, 120, 0, 24)
				sf.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
				sf.BorderSizePixel = 0
				sf.Parent = fr
				Instance.new("UICorner", sf).CornerRadius = UDim.new(0, 5)

				local sl = Instance.new("TextLabel")
				sl.Font = Enum.Font.Gotham
				sl.Text = "None"
				sl.TextSize = 11
				sl.TextColor3 = Color3.fromRGB(155, 155, 160)
				sl.TextTruncate = Enum.TextTruncate.AtEnd
				sl.TextXAlignment = Enum.TextXAlignment.Center
				sl.BackgroundTransparency = 1
				sl.Position = UDim2.new(0, 4, 0, 0)
				sl.Size = UDim2.new(1, -24, 1, 0)
				sl.Parent = sf

				local sa = Instance.new("ImageLabel")
				sa.Size = UDim2.new(0, 14, 0, 14)
				sa.AnchorPoint = Vector2.new(1, 0.5)
				sa.Position = UDim2.new(1, -4, 0.5, 0)
				sa.BackgroundTransparency = 1
				sa.Image = "rbxassetid://16851841101"
				sa.ImageColor3 = Color3.fromRGB(100, 100, 105)
				sa.Rotation = 180
				sa.Parent = sf

				local function updateLbl()
					if cfg.Multi then
						if not F.Value or #F.Value == 0 then sl.Text = "None"
						else
							local t = {}
							for _, v in ipairs(F.Value) do table.insert(t, tostring(v)) end
							sl.Text = table.concat(t, ", ")
						end
					else
						sl.Text = F.Value ~= nil and tostring(F.Value) or "None"
					end
				end

				function F:_apply()
					ConfigData[ck] = F.Value
					updateLbl()
					if cfg.Multi then
						pcall(cfg.Callback, F.Value)
					else
						pcall(cfg.Callback, F.Value ~= nil and tostring(F.Value) or "")
					end
				end

				dbtn.MouseButton1Click:Connect(function()
					openDropdownPanel(cfg.Title, F.Options, F, cfg.Multi)
				end)

				function F:Clear()
					F.Value = cfg.Multi and {} or nil
					F.Options = {}
					updateLbl()
				end

				function F:AddOption(opt)
					table.insert(F.Options, opt)
				end

				function F:Set(val)
					if cfg.Multi then
						F.Value = type(val) == "table" and val or {}
					else
						F.Value = (type(val) == "table" and val[1]) or val
					end
					F:_apply()
				end

				function F:SetValue(v) self:Set(v) end
				function F:GetValue() return self.Value end

				function F:SetValues(newList, sel)
					newList = newList or {}
					sel = sel or (cfg.Multi and {} or nil)
					F.Options = newList
					F:Set(sel)
				end

				updateLbl()
				if F.Value then F:Set(F.Value) end

				CountItem += 1
				Elements[ck] = F
				return F
			end

			function Items:AddInput(cfg)
				cfg = cfg or {}
				cfg.Title = cfg.Title or "Input"
				cfg.Callback = cfg.Callback or function() end
				cfg.Default = cfg.Default or ""

				local ck = "Input_" .. cfg.Title
				if ConfigData[ck] ~= nil then cfg.Default = ConfigData[ck] end

				local F = { Value = cfg.Default }

				local fr = Instance.new("Frame")
				fr.Size = UDim2.new(1, 0, 0, 54)
				fr.BackgroundColor3 = Color3.fromRGB(22, 22, 27)
				fr.BorderSizePixel = 0
				fr.LayoutOrder = CountItem
				fr.Parent = ItemHolder
				Instance.new("UICorner", fr).CornerRadius = UDim.new(0, 6)

				local itl = Instance.new("TextLabel")
				itl.Font = Enum.Font.GothamBold
				itl.Text = cfg.Title
				itl.TextSize = 12
				itl.TextColor3 = Color3.fromRGB(205, 205, 210)
				itl.TextXAlignment = Enum.TextXAlignment.Left
				itl.BackgroundTransparency = 1
				itl.Position = UDim2.new(0, 14, 0, 6)
				itl.Size = UDim2.new(1, -20, 0, 14)
				itl.Parent = fr

				local ib = Instance.new("TextBox")
				ib.Font = Enum.Font.Gotham
				ib.PlaceholderText = "Type here..."
				ib.PlaceholderColor3 = Color3.fromRGB(60, 60, 65)
				ib.Text = cfg.Default
				ib.TextSize = 11
				ib.TextColor3 = Color3.fromRGB(190, 190, 195)
				ib.TextXAlignment = Enum.TextXAlignment.Left
				ib.BackgroundColor3 = Color3.fromRGB(16, 16, 20)
				ib.BorderSizePixel = 0
				ib.Position = UDim2.new(0, 10, 0, 26)
				ib.Size = UDim2.new(1, -20, 0, 22)
				ib.ClearTextOnFocus = false
				ib.ClipsDescendants = true
				ib.Parent = fr
				Instance.new("UICorner", ib).CornerRadius = UDim.new(0, 4)
				local ibp = Instance.new("UIPadding")
				ibp.PaddingLeft = UDim.new(0, 8)
				ibp.Parent = ib

				function F:Set(val)
					F.Value = val
					ib.Text = val
					ConfigData[ck] = val
					pcall(cfg.Callback, val)
				end

				ib:GetPropertyChangedSignal("Text"):Connect(function()
					F.Value = ib.Text
					ConfigData[ck] = ib.Text
				end)

				ib.FocusLost:Connect(function() F:Set(ib.Text) end)
				F:Set(F.Value)

				CountItem += 1
				Elements[ck] = F
				return F
			end

			function Items:AddSubSection(title)
				title = title or "Sub Section"
				local sub = Instance.new("Frame")
				sub.Size = UDim2.new(1, 0, 0, 22)
				sub.BackgroundTransparency = 1
				sub.LayoutOrder = CountItem
				sub.Parent = ItemHolder

				local ll = Instance.new("TextLabel")
				ll.Font = Enum.Font.GothamBold
				ll.Text = title
				ll.TextSize = 11
				ll.TextColor3 = Color3.fromRGB(80, 80, 88)
				ll.TextXAlignment = Enum.TextXAlignment.Left
				ll.BackgroundTransparency = 1
				ll.Position = UDim2.new(0, 4, 0, 5)
				ll.Size = UDim2.new(1, -8, 0, 14)
				ll.Parent = sub

				CountItem += 1
				return sub
			end

			function Items:AddButton(cfg)
				cfg = cfg or {}
				cfg.Title = cfg.Title or "Button"
				cfg.Callback = cfg.Callback or function() end
				cfg.SubTitle = cfg.SubTitle or nil
				cfg.SubCallback = cfg.SubCallback or function() end

				local fr = Instance.new("Frame")
				fr.Size = UDim2.new(1, 0, 0, 34)
				fr.BackgroundColor3 = Color3.fromRGB(22, 22, 27)
				fr.BorderSizePixel = 0
				fr.LayoutOrder = CountItem
				fr.Parent = ItemHolder
				Instance.new("UICorner", fr).CornerRadius = UDim.new(0, 6)

				local mb = Instance.new("TextButton")
				mb.Font = Enum.Font.GothamBold
				mb.Text = cfg.Title
				mb.TextSize = 11
				mb.TextColor3 = Color3.fromRGB(195, 195, 200)
				mb.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
				mb.BorderSizePixel = 0
				mb.AutoButtonColor = false
				mb.Parent = fr
				Instance.new("UICorner", mb).CornerRadius = UDim.new(0, 4)

				if cfg.SubTitle then
					mb.Size = UDim2.new(0.5, -6, 0, 26)
					mb.Position = UDim2.new(0, 4, 0, 4)

					local sb = Instance.new("TextButton")
					sb.Font = Enum.Font.GothamBold
					sb.Text = cfg.SubTitle
					sb.TextSize = 11
					sb.TextColor3 = Color3.fromRGB(195, 195, 200)
					sb.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
					sb.BorderSizePixel = 0
					sb.AutoButtonColor = false
					sb.Size = UDim2.new(0.5, -6, 0, 26)
					sb.Position = UDim2.new(0.5, 2, 0, 4)
					sb.Parent = fr
					Instance.new("UICorner", sb).CornerRadius = UDim.new(0, 4)

					sb.MouseButton1Click:Connect(function()
						TweenService:Create(sb, TweenInfo.new(0.08), { BackgroundColor3 = Color3.fromRGB(48, 48, 54) }):Play()
						task.delay(0.12, function()
							TweenService:Create(sb, TweenInfo.new(0.1), { BackgroundColor3 = Color3.fromRGB(30, 30, 35) }):Play()
						end)
						pcall(cfg.SubCallback)
					end)
				else
					mb.Size = UDim2.new(1, -8, 0, 26)
					mb.Position = UDim2.new(0, 4, 0, 4)
				end

				mb.MouseButton1Click:Connect(function()
					TweenService:Create(mb, TweenInfo.new(0.08), { BackgroundColor3 = Color3.fromRGB(48, 48, 54) }):Play()
					task.delay(0.12, function()
						TweenService:Create(mb, TweenInfo.new(0.1), { BackgroundColor3 = Color3.fromRGB(30, 30, 35) }):Play()
					end)
					pcall(cfg.Callback)
				end)

				CountItem += 1
			end

			function Items:AddParagraph(cfg)
				cfg = cfg or {}
				cfg.Title = cfg.Title or "Info"
				cfg.Content = cfg.Content or ""

				local PF = {}

				local fr = Instance.new("Frame")
				fr.Size = UDim2.new(1, 0, 0, 40)
				fr.BackgroundColor3 = Color3.fromRGB(22, 22, 27)
				fr.BorderSizePixel = 0
				fr.LayoutOrder = CountItem
				fr.Parent = ItemHolder
				Instance.new("UICorner", fr).CornerRadius = UDim.new(0, 6)

				local pt = Instance.new("TextLabel")
				pt.Font = Enum.Font.GothamBold
				pt.Text = cfg.Title
				pt.TextSize = 12
				pt.TextColor3 = Color3.fromRGB(205, 205, 210)
				pt.TextXAlignment = Enum.TextXAlignment.Left
				pt.BackgroundTransparency = 1
				pt.Position = UDim2.new(0, 14, 0, 6)
				pt.Size = UDim2.new(1, -20, 0, 14)
				pt.Parent = fr

				local pc = Instance.new("TextLabel")
				pc.Font = Enum.Font.Gotham
				pc.Text = cfg.Content
				pc.TextSize = 11
				pc.TextColor3 = Color3.fromRGB(135, 135, 142)
				pc.TextXAlignment = Enum.TextXAlignment.Left
				pc.TextWrapped = true
				pc.RichText = true
				pc.BackgroundTransparency = 1
				pc.Position = UDim2.new(0, 14, 0, 22)
				pc.Size = UDim2.new(1, -20, 0, 14)
				pc.Parent = fr

				local function upd()
					task.defer(function()
						local h = math.max(14, pc.TextBounds.Y)
						pc.Size = UDim2.new(1, -20, 0, h)
						fr.Size = UDim2.new(1, 0, 0, 28 + h)
						updateSize()
					end)
				end

				pc:GetPropertyChangedSignal("TextBounds"):Connect(upd)
				upd()

				function PF:SetContent(c)
					pc.Text = c or ""
				end

				CountItem += 1
				return PF
			end

			function Items:AddSlider(cfg)
				cfg = cfg or {}
				cfg.Title = cfg.Title or "Slider"
				cfg.Increment = cfg.Increment or 1
				cfg.Min = cfg.Min or 0
				cfg.Max = cfg.Max or 100
				cfg.Default = cfg.Default or 50
				cfg.Callback = cfg.Callback or function() end

				local ck = "Slider_" .. cfg.Title
				if ConfigData[ck] ~= nil then cfg.Default = ConfigData[ck] end

				local F = { Value = cfg.Default }

				local fr = Instance.new("Frame")
				fr.Size = UDim2.new(1, 0, 0, 40)
				fr.BackgroundColor3 = Color3.fromRGB(22, 22, 27)
				fr.BorderSizePixel = 0
				fr.LayoutOrder = CountItem
				fr.Parent = ItemHolder
				Instance.new("UICorner", fr).CornerRadius = UDim.new(0, 6)

				local stl = Instance.new("TextLabel")
				stl.Font = Enum.Font.GothamBold
				stl.Text = cfg.Title
				stl.TextSize = 12
				stl.TextColor3 = Color3.fromRGB(205, 205, 210)
				stl.TextXAlignment = Enum.TextXAlignment.Left
				stl.BackgroundTransparency = 1
				stl.Position = UDim2.new(0, 14, 0, 4)
				stl.Size = UDim2.new(0.5, 0, 0, 14)
				stl.Parent = fr

				local vl = Instance.new("TextLabel")
				vl.Font = Enum.Font.GothamBold
				vl.Text = tostring(cfg.Default)
				vl.TextSize = 11
				vl.TextColor3 = Color3.fromRGB(150, 150, 158)
				vl.TextXAlignment = Enum.TextXAlignment.Right
				vl.BackgroundTransparency = 1
				vl.AnchorPoint = Vector2.new(1, 0)
				vl.Position = UDim2.new(1, -14, 0, 4)
				vl.Size = UDim2.new(0.3, 0, 0, 14)
				vl.Parent = fr

				local trk = Instance.new("Frame")
				trk.Position = UDim2.new(0, 14, 0, 26)
				trk.Size = UDim2.new(1, -28, 0, 4)
				trk.BackgroundColor3 = Color3.fromRGB(38, 38, 44)
				trk.BorderSizePixel = 0
				trk.Parent = fr
				Instance.new("UICorner", trk).CornerRadius = UDim.new(1, 0)

				local fill = Instance.new("Frame")
				fill.Size = UDim2.new(0.5, 0, 1, 0)
				fill.BackgroundColor3 = Accent
				fill.BorderSizePixel = 0
				fill.Parent = trk
				Instance.new("UICorner", fill).CornerRadius = UDim.new(1, 0)

				local knob = Instance.new("Frame")
				knob.AnchorPoint = Vector2.new(1, 0.5)
				knob.Position = UDim2.new(1, 2, 0.5, 0)
				knob.Size = UDim2.new(0, 10, 0, 10)
				knob.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
				knob.BorderSizePixel = 0
				knob.ZIndex = 3
				knob.Parent = fill
				Instance.new("UICorner", knob).CornerRadius = UDim.new(1, 0)

				local dr = false

				local function rnd(n, f) return math.floor(n / f + 0.5) * f end

				function F:Set(val)
					val = math.clamp(rnd(val, cfg.Increment), cfg.Min, cfg.Max)
					F.Value = val
					vl.Text = tostring(val)
					local pct = (val - cfg.Min) / (cfg.Max - cfg.Min)
					TweenService:Create(fill, TweenInfo.new(0.08), { Size = UDim2.new(pct, 0, 1, 0) }):Play()
					ConfigData[ck] = val
					pcall(cfg.Callback, val)
				end

				trk.InputBegan:Connect(function(input)
					if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
						dr = true
						local p = math.clamp((input.Position.X - trk.AbsolutePosition.X) / trk.AbsoluteSize.X, 0, 1)
						F:Set(cfg.Min + (cfg.Max - cfg.Min) * p)
					end
				end)

				trk.InputEnded:Connect(function(input)
					if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
						dr = false
					end
				end)

				UserInputService.InputChanged:Connect(function(input)
					if dr and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
						local p = math.clamp((input.Position.X - trk.AbsolutePosition.X) / trk.AbsoluteSize.X, 0, 1)
						F:Set(cfg.Min + (cfg.Max - cfg.Min) * p)
					end
				end)

				F:Set(cfg.Default)
				CountItem += 1
				Elements[ck] = F
				return F
			end

			function Items:AddDivider()
				local d = Instance.new("Frame")
				d.Size = UDim2.new(1, 0, 0, 6)
				d.BackgroundTransparency = 1
				d.LayoutOrder = CountItem
				d.Parent = ItemHolder

				local ln = Instance.new("Frame")
				ln.AnchorPoint = Vector2.new(0.5, 0.5)
				ln.Position = UDim2.new(0.5, 0, 0.5, 0)
				ln.Size = UDim2.new(1, -6, 0, 1)
				ln.BackgroundColor3 = Color3.fromRGB(36, 36, 42)
				ln.BorderSizePixel = 0
				ln.Parent = d

				CountItem += 1
				return d
			end

			function Items:AddPanel(cfg)
				cfg = cfg or {}
				cfg.Title = cfg.Title or "Panel"
				cfg.Content = cfg.Content or ""
				cfg.Placeholder = cfg.Placeholder or nil
				cfg.Default = cfg.Default or ""
				cfg.ButtonText = cfg.Button or cfg.ButtonText or "Confirm"
				cfg.ButtonCallback = cfg.Callback or cfg.ButtonCallback or function() end
				cfg.SubButtonText = cfg.SubButton or cfg.SubButtonText or nil
				cfg.SubButtonCallback = cfg.SubCallback or cfg.SubButtonCallback or function() end

				local ck2 = "Panel_" .. cfg.Title
				if ConfigData[ck2] ~= nil then cfg.Default = ConfigData[ck2] end

				local PF = { Value = cfg.Default }
				local th = 44
				if cfg.Placeholder then th = th + 30 end
				th = th + 32

				local fr = Instance.new("Frame")
				fr.Size = UDim2.new(1, 0, 0, th)
				fr.BackgroundColor3 = Color3.fromRGB(22, 22, 27)
				fr.BorderSizePixel = 0
				fr.LayoutOrder = CountItem
				fr.Parent = ItemHolder
				Instance.new("UICorner", fr).CornerRadius = UDim.new(0, 6)

				local ptl = Instance.new("TextLabel")
				ptl.Font = Enum.Font.GothamBold
				ptl.Text = cfg.Title
				ptl.TextSize = 12
				ptl.TextColor3 = Color3.fromRGB(205, 205, 210)
				ptl.TextXAlignment = Enum.TextXAlignment.Left
				ptl.BackgroundTransparency = 1
				ptl.Position = UDim2.new(0, 14, 0, 6)
				ptl.Size = UDim2.new(1, -20, 0, 14)
				ptl.Parent = fr

				local pcl = Instance.new("TextLabel")
				pcl.Font = Enum.Font.Gotham
				pcl.Text = cfg.Content
				pcl.TextSize = 10
				pcl.TextColor3 = Color3.fromRGB(130, 130, 138)
				pcl.TextXAlignment = Enum.TextXAlignment.Left
				pcl.RichText = true
				pcl.BackgroundTransparency = 1
				pcl.Position = UDim2.new(0, 14, 0, 24)
				pcl.Size = UDim2.new(1, -20, 0, 12)
				pcl.Parent = fr

				local yOff = 40
				local InputBox

				if cfg.Placeholder then
					InputBox = Instance.new("TextBox")
					InputBox.Font = Enum.Font.Gotham
					InputBox.PlaceholderText = cfg.Placeholder
					InputBox.PlaceholderColor3 = Color3.fromRGB(60, 60, 65)
					InputBox.Text = cfg.Default
					InputBox.TextSize = 11
					InputBox.TextColor3 = Color3.fromRGB(190, 190, 195)
					InputBox.TextXAlignment = Enum.TextXAlignment.Left
					InputBox.BackgroundColor3 = Color3.fromRGB(16, 16, 20)
					InputBox.BorderSizePixel = 0
					InputBox.Position = UDim2.new(0, 10, 0, yOff)
					InputBox.Size = UDim2.new(1, -20, 0, 22)
					InputBox.ClearTextOnFocus = false
					InputBox.Parent = fr
					Instance.new("UICorner", InputBox).CornerRadius = UDim.new(0, 4)
					local ibpad = Instance.new("UIPadding")
					ibpad.PaddingLeft = UDim.new(0, 6)
					ibpad.Parent = InputBox
					yOff = yOff + 28
				end

				local mbtn = Instance.new("TextButton")
				mbtn.Font = Enum.Font.GothamBold
				mbtn.Text = cfg.ButtonText
				mbtn.TextSize = 11
				mbtn.TextColor3 = Color3.fromRGB(195, 195, 200)
				mbtn.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
				mbtn.BorderSizePixel = 0
				mbtn.AutoButtonColor = false
				mbtn.Parent = fr
				Instance.new("UICorner", mbtn).CornerRadius = UDim.new(0, 4)

				if cfg.SubButtonText then
					mbtn.Size = UDim2.new(0.5, -12, 0, 26)
					mbtn.Position = UDim2.new(0, 10, 0, yOff)

					local sbt = Instance.new("TextButton")
					sbt.Font = Enum.Font.GothamBold
					sbt.Text = cfg.SubButtonText
					sbt.TextSize = 11
					sbt.TextColor3 = Color3.fromRGB(195, 195, 200)
					sbt.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
					sbt.BorderSizePixel = 0
					sbt.AutoButtonColor = false
					sbt.Size = UDim2.new(0.5, -12, 0, 26)
					sbt.Position = UDim2.new(0.5, 2, 0, yOff)
					sbt.Parent = fr
					Instance.new("UICorner", sbt).CornerRadius = UDim.new(0, 4)

					sbt.MouseButton1Click:Connect(function()
						pcall(cfg.SubButtonCallback, InputBox and InputBox.Text or "")
					end)
				else
					mbtn.Size = UDim2.new(1, -20, 0, 26)
					mbtn.Position = UDim2.new(0, 10, 0, yOff)
				end

				mbtn.MouseButton1Click:Connect(function()
					pcall(cfg.ButtonCallback, InputBox and InputBox.Text or "")
				end)

				if InputBox then
					InputBox.FocusLost:Connect(function()
						PF.Value = InputBox.Text
						ConfigData[ck2] = InputBox.Text
					end)
				end

				function PF:GetInput()
					return InputBox and InputBox.Text or ""
				end

				CountItem += 1
				return PF
			end

			function Items:AddConfigPanel()
				local selectedConfigName = CurrentConfigName or ""

				local StatusParagraph = Items:AddParagraph({
					Title = "Config Manager",
					Content = "Current: " .. (CurrentConfigName or "None") .. " | Autoload: " .. (GetAutoload() or "None"),
				})

				local ConfigNameInput = Items:AddInput({
					Title = "Config Name",
					Default = CurrentConfigName or "",
					Callback = function(v) selectedConfigName = v end,
				})

				local configs = GetConfigList()
				local ConfigDropdown = Items:AddDropdown({
					Title = "Select Config",
					Options = configs,
					Default = nil,
					Callback = function(sel)
						selectedConfigName = sel
						ConfigNameInput:Set(sel)
					end,
				})

				Items:AddButton({
					Title = "Save",
					SubTitle = "Load",
					Callback = function()
						if selectedConfigName ~= "" then
							if SaveConfigAs(selectedConfigName) then
								Notify("Config saved: " .. selectedConfigName, 3, Color3.fromRGB(100, 255, 130))
								ConfigDropdown:SetValues(GetConfigList())
								StatusParagraph:SetContent("Current: " .. selectedConfigName .. " | Autoload: " .. (GetAutoload() or "None"))
							end
						end
					end,
					SubCallback = function()
						if selectedConfigName ~= "" then
							if LoadConfig(selectedConfigName) then
								Notify("Config loaded: " .. selectedConfigName, 3, Color3.fromRGB(100, 255, 130))
								StatusParagraph:SetContent("Current: " .. selectedConfigName .. " | Autoload: " .. (GetAutoload() or "None"))
							end
						end
					end,
				})

				Items:AddButton({
					Title = "Delete",
					SubTitle = "Set Autoload",
					Callback = function()
						if selectedConfigName ~= "" then
							if DeleteConfig(selectedConfigName) then
								Notify("Deleted: " .. selectedConfigName, 3, Color3.fromRGB(255, 100, 100))
								selectedConfigName = ""
								ConfigNameInput:Set("")
								ConfigDropdown:SetValues(GetConfigList())
								StatusParagraph:SetContent("Current: " .. (CurrentConfigName or "None") .. " | Autoload: " .. (GetAutoload() or "None"))
							end
						end
					end,
					SubCallback = function()
						if selectedConfigName ~= "" then
							SetAutoload(selectedConfigName)
							Notify("Autoload: " .. selectedConfigName, 3, Color3.fromRGB(100, 180, 255))
							StatusParagraph:SetContent("Current: " .. (CurrentConfigName or "None") .. " | Autoload: " .. selectedConfigName)
						end
					end,
				})

				Items:AddButton({
					Title = "Refresh List",
					SubTitle = "Clear Autoload",
					Callback = function()
						local nc = GetConfigList()
						ConfigDropdown:SetValues(nc)
						Notify("Refreshed (" .. #nc .. ")", 2, Color3.fromRGB(150, 150, 255))
					end,
					SubCallback = function()
						ClearAutoload()
						Notify("Autoload cleared", 3, Color3.fromRGB(200, 200, 100))
						StatusParagraph:SetContent("Current: " .. (CurrentConfigName or "None") .. " | Autoload: None")
					end,
				})

				Items:AddButton({
					Title = "Reset All Elements",
					Callback = function()
						ResetElements()
						Notify("All elements reset", 3, Color3.fromRGB(255, 200, 100))
					end,
				})

				Items:AddButton({
					Title = "Export Config",
					Callback = function()
						if not setclipboard then
							Notify("Clipboard not supported", 3, Color3.fromRGB(255, 100, 100))
							return
						end
						ConfigData._version = CURRENT_VERSION
						setclipboard(HttpService:JSONEncode(ConfigData))
						Notify("Config copied to clipboard", 3, Color3.fromRGB(100, 255, 130))
					end,
				})

				Items:AddSubSection("Import External")

				Items:AddInput({
					Title = "External JSON",
					Default = "",
					Callback = function() end,
				})

				Items:AddButton({
					Title = "Import Config",
					Callback = function()
						local inp = Elements["Input_External JSON"]
						local json = inp and inp.Value
						if not json or json == "" then
							Notify("JSON is empty", 3, Color3.fromRGB(255, 100, 100))
							return
						end
						ResetElements()
						local ok = pcall(function() LoadExternalConfigFromJSON(json) end)
						if ok then
							Notify("External config loaded", 3, Color3.fromRGB(100, 255, 130))
							StatusParagraph:SetContent("Current: External | Autoload: " .. (GetAutoload() or "None"))
						else
							Notify("Failed to load JSON", 3, Color3.fromRGB(255, 100, 100))
						end
					end,
				})

				return {
					UpdateStatus = function()
						StatusParagraph:SetContent("Current: " .. (CurrentConfigName or "None") .. " | Autoload: " .. (GetAutoload() or "None"))
					end,
					RefreshList = function()
						ConfigDropdown:SetValues(GetConfigList())
					end,
				}
			end

			CountSection += 1
			return Items
		end

		CountTab += 1
		local safeName = TabConfig.Name:gsub("%s+", "_")
		_G[safeName] = Sections
		return Sections
	end

	return Tabs
end

return Orion
